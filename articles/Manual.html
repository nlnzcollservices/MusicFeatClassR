<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MusicFeatClassR">
<title>Manual • MusicFeatClassR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manual">
<meta property="og:description" content="MusicFeatClassR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MusicFeatClassR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Manual.html">Manual</a>
    <a class="dropdown-item" href="../articles/Testing_plan.html">Testing plan</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Manual</h1>
                        <h4 data-toc-skip class="author">Svetlana
Koroteeva</h4>
            
            <h4 data-toc-skip class="date">2023-10-20</h4>
      
      
      <div class="d-none name"><code>Manual.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="musicfeatclassr-package">MusicFeatClassR package<a class="anchor" aria-label="anchor" href="#musicfeatclassr-package"></a>
</h2>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>The MusicFeatClassR package aims to provide an end-to-end solution
for music genre classification using Machine Learning (ML) techniques.
The primary problem it addresses is automating the process of music
genre classification, which involves extracting essential features from
music datasets and training ML classifiers to predict the genre of
music.</p>
<p>The MusicFeatClassR package consists of two main separate parts:
feature extraction and classification.</p>
</div>
<div class="section level3">
<h3 id="feature-extraction">Feature extraction<a class="anchor" aria-label="anchor" href="#feature-extraction"></a>
</h3>
<p>It also has specific data requirements. The music dataset consists of
Dissemination Information Packages (DIP) extracted from a Library
preservation system based on OAIS. Another important file is
“ies_mms_label.txt,” which contains identification numbers and class
labels extracted from the library system (Note: Collecting class labels
from the library system is not yet implemented).</p>
<p>For preparation, place the music dataset in the “files/mp3” folder
and the “ies_mms_label.txt” file in the “inst/csv” folder. You can find
all code examples in the “inst/scripts” folder. Currently, only mp3
feature extraction is implemented.</p>
<p>Please note that the example dataset contains only 10 DIP folders. It
is not sufficient for classification but serves as a test to ensure that
feature extraction is working.</p>
<p>To initiate the feature extraction process, you can either run the
“run_extraction.R” script or copy the following code snippet. This
script will extract features from the music dataset, extract text
metadata from “ie.xml” files (inside each DIP), and match them with
labels from your “mms_ies_label.txt” file. It will create one metadata
row for each music file, bind them to the main data frame, write the
data frame to a CSV output file (“extracted_features.csv”), and return
the data frame. Let’s get started.</p>
<p>Ensure that you have loaded all the necessary libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xml2.r-lib.org/" class="external-link">xml2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tuneR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlnzcollservices.github.io/MusicFeatClassR/">MusicFeatClassR</a></span><span class="op">)</span> <span class="co"># the package</span></span></code></pre></div>
<p>Here, you can customize the names of the output and input files,
which contain labels. Before running the main pipeline, you should
specify label_file_path, csv_file_path, and filesdir (for music
packages).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csv_file_name</span><span class="op">&lt;-</span><span class="st">"extracted_features.csv"</span></span>
<span><span class="va">label_file</span><span class="op">&lt;-</span><span class="st">"ies_mms_label.txt"</span></span>
<span><span class="va">vignettes_dir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">parent_dir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">vignettes_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">csv_files_path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">parent_dir</span>, <span class="st">"inst"</span>,<span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">csv_file_path</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">csv_files_path</span>, <span class="va">csv_file_name</span><span class="op">)</span></span>
<span><span class="va">label_file_path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">csv_files_path</span>, <span class="va">label_file</span><span class="op">)</span></span>
<span><span class="va">filesdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">parent_dir</span>,<span class="st">'files'</span>,<span class="st">'mp3'</span><span class="op">)</span></span></code></pre></div>
<p>Now you can initiate the pipeline. The entire process may take a
couple of hours on the original dataset (please note that the example
dataset only contains 10 albums). If the process is interrupted, the
script will pick up from the last processed DIP folder in the next
run.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span><span class="op">&lt;-</span><span class="fu">rpipeline</span><span class="op">(</span><span class="va">label_file_path</span>, <span class="va">csv_file_path</span>, <span class="va">filesdir</span><span class="op">)</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ie_number...2` -&gt; `ie_number...3`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `ie_number...18` -&gt; `ie_number...19`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#&gt; $label_file_path</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/ies_mms_label.txt"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $csv_file_path</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/extracted_features.csv"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $root_dir</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/MusicFeatClassR/MusicFeatClassR/files/mp3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $feature_data</span></span>
<span><span class="co">#&gt;   X file_type ie_number...3  rep_number                     file_name duration</span></span>
<span><span class="co">#&gt; 1 1       mp3     IE1017269 REP74080121 FL74080122_1212219_PM_S_1.mp3  309.912</span></span>
<span><span class="co">#&gt; 2 2       mp3     IE1017269 REP74080121 FL74080125_1212219_PM_S_2.mp3  338.808</span></span>
<span><span class="co">#&gt;   sample_rate num_channels amplitude         xml_title</span></span>
<span><span class="co">#&gt; 1       48000     14875776     14070 The Kini Quartet.</span></span>
<span><span class="co">#&gt; 2       48000     16262784     20921 The Kini Quartet.</span></span>
<span><span class="co">#&gt;                          xml_creators         xml_type</span></span>
<span><span class="co">#&gt; 1 Kini Quartet.||Raggett, Margarette. Sound Recordings</span></span>
<span><span class="co">#&gt; 2 Kini Quartet.||Raggett, Margarette. Sound Recordings</span></span>
<span><span class="co">#&gt;                            xml_publisher xml_date xml_language xml_identifier</span></span>
<span><span class="co">#&gt; 1 Auckland, N.Z. :               Zodiac,   [1967]          mao      IE1017269</span></span>
<span><span class="co">#&gt; 2 Auckland, N.Z. :               Zodiac,   [1967]          mao      IE1017269</span></span>
<span><span class="co">#&gt;   xml_bibliographicCitation          mms ie_number...19 label_code</span></span>
<span><span class="co">#&gt; 1         The Kini Quartet. 9.912122e+15      IE1017269         pp</span></span>
<span><span class="co">#&gt; 2         The Kini Quartet. 9.912122e+15      IE1017269         pp</span></span>
<span><span class="co">#&gt;          label1        label2 label3 label4 label5</span></span>
<span><span class="co">#&gt; 1 Popular music Songs, Māori.     NA     NA     NA</span></span>
<span><span class="co">#&gt; 2 Popular music Songs, Māori.     NA     NA     NA</span></span></code></pre></div>
<p>For the purpose of data analysis, three S3 class methods for
‘rpipeline’ were developed: ‘print,’ ‘summary,’ and ‘plot.’</p>
<p>Currently, they are in a ‘draft’ stage and will be further developed
for the complete package. (Note: To test the ‘plot’ S3 method, you need
to load the ‘plot.rpipeline’ function into memory first, as it may not
work well within the package.)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Custom rpipeline object</span></span>
<span><span class="co">#&gt; Label File Path: /home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/ies_mms_label.txt </span></span>
<span><span class="co">#&gt; CSV File Path: /home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/extracted_features.csv </span></span>
<span><span class="co">#&gt; Root Directory: /home/runner/work/MusicFeatClassR/MusicFeatClassR/files/mp3 </span></span>
<span><span class="co">#&gt; Feature Data Summary:</span></span>
<span><span class="co">#&gt;   X file_type ie_number...3  rep_number                     file_name duration</span></span>
<span><span class="co">#&gt; 1 1       mp3     IE1017269 REP74080121 FL74080122_1212219_PM_S_1.mp3  309.912</span></span>
<span><span class="co">#&gt; 2 2       mp3     IE1017269 REP74080121 FL74080125_1212219_PM_S_2.mp3  338.808</span></span>
<span><span class="co">#&gt;   sample_rate num_channels amplitude         xml_title</span></span>
<span><span class="co">#&gt; 1       48000     14875776     14070 The Kini Quartet.</span></span>
<span><span class="co">#&gt; 2       48000     16262784     20921 The Kini Quartet.</span></span>
<span><span class="co">#&gt;                          xml_creators         xml_type</span></span>
<span><span class="co">#&gt; 1 Kini Quartet.||Raggett, Margarette. Sound Recordings</span></span>
<span><span class="co">#&gt; 2 Kini Quartet.||Raggett, Margarette. Sound Recordings</span></span>
<span><span class="co">#&gt;                            xml_publisher xml_date xml_language xml_identifier</span></span>
<span><span class="co">#&gt; 1 Auckland, N.Z. :               Zodiac,   [1967]          mao      IE1017269</span></span>
<span><span class="co">#&gt; 2 Auckland, N.Z. :               Zodiac,   [1967]          mao      IE1017269</span></span>
<span><span class="co">#&gt;   xml_bibliographicCitation          mms ie_number...19 label_code</span></span>
<span><span class="co">#&gt; 1         The Kini Quartet. 9.912122e+15      IE1017269         pp</span></span>
<span><span class="co">#&gt; 2         The Kini Quartet. 9.912122e+15      IE1017269         pp</span></span>
<span><span class="co">#&gt;          label1        label2 label3 label4 label5</span></span>
<span><span class="co">#&gt; 1 Popular music Songs, Māori.     NA     NA     NA</span></span>
<span><span class="co">#&gt; 2 Popular music Songs, Māori.     NA     NA     NA</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of rpipeline object</span></span>
<span><span class="co">#&gt; Label File Path: /home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/ies_mms_label.txt </span></span>
<span><span class="co">#&gt; CSV File Path: /home/runner/work/MusicFeatClassR/MusicFeatClassR/inst/csv/extracted_features.csv </span></span>
<span><span class="co">#&gt; Root Directory: /home/runner/work/MusicFeatClassR/MusicFeatClassR/files/mp3 </span></span>
<span><span class="co">#&gt; Feature Data Summary:</span></span>
<span><span class="co">#&gt;        X         file_type         ie_number...3       rep_number       </span></span>
<span><span class="co">#&gt;  Min.   :1.00   Length:2           Length:2           Length:2          </span></span>
<span><span class="co">#&gt;  1st Qu.:1.25   Class :character   Class :character   Class :character  </span></span>
<span><span class="co">#&gt;  Median :1.50   Mode  :character   Mode  :character   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :1.50                                                           </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.75                                                           </span></span>
<span><span class="co">#&gt;  Max.   :2.00                                                           </span></span>
<span><span class="co">#&gt;   file_name            duration      sample_rate     num_channels     </span></span>
<span><span class="co">#&gt;  Length:2           Min.   :309.9   Min.   :48000   Min.   :14875776  </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.:317.1   1st Qu.:48000   1st Qu.:15222528  </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :324.4   Median :48000   Median :15569280  </span></span>
<span><span class="co">#&gt;                     Mean   :324.4   Mean   :48000   Mean   :15569280  </span></span>
<span><span class="co">#&gt;                     3rd Qu.:331.6   3rd Qu.:48000   3rd Qu.:15916032  </span></span>
<span><span class="co">#&gt;                     Max.   :338.8   Max.   :48000   Max.   :16262784  </span></span>
<span><span class="co">#&gt;    amplitude      xml_title         xml_creators         xml_type        </span></span>
<span><span class="co">#&gt;  Min.   :14070   Length:2           Length:2           Length:2          </span></span>
<span><span class="co">#&gt;  1st Qu.:15783   Class :character   Class :character   Class :character  </span></span>
<span><span class="co">#&gt;  Median :17496   Mode  :character   Mode  :character   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :17496                                                           </span></span>
<span><span class="co">#&gt;  3rd Qu.:19208                                                           </span></span>
<span><span class="co">#&gt;  Max.   :20921                                                           </span></span>
<span><span class="co">#&gt;  xml_publisher        xml_date         xml_language       xml_identifier    </span></span>
<span><span class="co">#&gt;  Length:2           Length:2           Length:2           Length:2          </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   Class :character   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character   Mode  :character  </span></span>
<span><span class="co">#&gt;                                                                             </span></span>
<span><span class="co">#&gt;                                                                             </span></span>
<span><span class="co">#&gt;                                                                             </span></span>
<span><span class="co">#&gt;  xml_bibliographicCitation      mms            ie_number...19    </span></span>
<span><span class="co">#&gt;  Length:2                  Min.   :9.912e+15   Length:2          </span></span>
<span><span class="co">#&gt;  Class :character          1st Qu.:9.912e+15   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character          Median :9.912e+15   Mode  :character  </span></span>
<span><span class="co">#&gt;                            Mean   :9.912e+15                     </span></span>
<span><span class="co">#&gt;                            3rd Qu.:9.912e+15                     </span></span>
<span><span class="co">#&gt;                            Max.   :9.912e+15                     </span></span>
<span><span class="co">#&gt;   label_code           label1             label2           label3       </span></span>
<span><span class="co">#&gt;  Length:2           Length:2           Length:2           Mode:logical  </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   Class :character   NA's:2        </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character                 </span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt;   label4         label5       </span></span>
<span><span class="co">#&gt;  Mode:logical   Mode:logical  </span></span>
<span><span class="co">#&gt;  NA's:2         NA's:2        </span></span>
<span><span class="co">#&gt;                               </span></span>
<span><span class="co">#&gt;                               </span></span>
<span><span class="co">#&gt;                               </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Note: Currently “plot” does not load correctly, so I copied the
script here</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cor(df_numeric): the standard deviation is zero</span></span></code></pre></div>
<p><img src="Manual_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h3>
<p>Once you have collected all the features from your dataset, you can
proceed to the next stage - Machine Learning (ML) classification. The
source of classification is a dataframe built from the
“extracted_features.csv” file; however, since the example music dataset
is relatively small, please consider using the
“extracted_features_original.csv” file, which contains more than 50,000
rows of data.</p>
<p>In addition to Random Forest, which is considered one of the best
classifiers, the package also includes Naive Bayes, Support Vector
Machine, and Logistic Regression methods. You can call the specific
method by replacing “RandomForest” with “LogisticRegression,”
“NaiveBayes,” or “SupportVectorMachine.”</p>
<p>To initiate the classification process, you can use the “classify.R”
code from the “inst/scripts” directory or copy it from the code
snippets.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">randomForest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rcpp.org" class="external-link">Rcpp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlnzcollservices.github.io/MusicFeatClassR/">MusicFeatClassR</a></span><span class="op">)</span></span>
<span><span class="va">csv_file_name</span><span class="op">&lt;-</span><span class="st">"extracted_features_original.csv"</span></span>
<span><span class="va">vignettes_dir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">parent_dir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">vignettes_dir</span><span class="op">)</span></span>
<span><span class="va">csv_files_path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">parent_dir</span>, <span class="st">"inst"</span>,<span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">csv_file_path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">csv_files_path</span>, <span class="va">csv_file_name</span><span class="op">)</span></span>
<span><span class="va">feature_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">csv_file_path</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">train_classifier</span><span class="op">(</span><span class="va">feature_data</span>, target_variable <span class="op">=</span> <span class="st">"label_code"</span>,classif <span class="op">=</span> <span class="st">"RandomForest"</span><span class="op">)</span></span></code></pre></div>
<p>Class result also has print and summary methods</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; $accuracy</span></span>
<span><span class="co">#&gt; [1] 0.727957</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt; Confusion Matrix and Statistics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Reference</span></span>
<span><span class="co">#&gt; Prediction  bl  cy  df  fm  jz  pp  rc  sg  uu  zz</span></span>
<span><span class="co">#&gt;         bl  11   0   0   0   0   1   0   0   0   1</span></span>
<span><span class="co">#&gt;         cy   0  12   0   0   1   3   0   2   0   2</span></span>
<span><span class="co">#&gt;         df   0   1  40   2   1   3   4   0   1   4</span></span>
<span><span class="co">#&gt;         fm   0   1   0  30   0   6   4   3   1   2</span></span>
<span><span class="co">#&gt;         jz   0   0   2   1  43   5   6   0   0   4</span></span>
<span><span class="co">#&gt;         pp   0   4   3   5   4 139  25   8   2  11</span></span>
<span><span class="co">#&gt;         rc   2   2  21   3  14  20 423   9   8  74</span></span>
<span><span class="co">#&gt;         sg   0   3   1   1   0   2   4   8   0   4</span></span>
<span><span class="co">#&gt;         uu   0   0   0   0   0   0   1   0   1   4</span></span>
<span><span class="co">#&gt;         zz   0   4  20   3  11  45 116   7   4 647</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall Statistics</span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;                Accuracy : 0.728           </span></span>
<span><span class="co">#&gt;                  95% CI : (0.7071, 0.7481)</span></span>
<span><span class="co">#&gt;     No Information Rate : 0.4048          </span></span>
<span><span class="co">#&gt;     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;                   Kappa : 0.6111          </span></span>
<span><span class="co">#&gt;                                           </span></span>
<span><span class="co">#&gt;  Mcnemar's Test P-Value : NA              </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistics by Class:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Class: bl Class: cy Class: df Class: fm Class: jz</span></span>
<span><span class="co">#&gt; Sensitivity           0.846154  0.444444   0.45977   0.66667   0.58108</span></span>
<span><span class="co">#&gt; Specificity           0.998917  0.995636   0.99098   0.99063   0.98992</span></span>
<span><span class="co">#&gt; Pos Pred Value        0.846154  0.600000   0.71429   0.63830   0.70492</span></span>
<span><span class="co">#&gt; Neg Pred Value        0.998917  0.991848   0.97395   0.99173   0.98277</span></span>
<span><span class="co">#&gt; Prevalence            0.006989  0.014516   0.04677   0.02419   0.03978</span></span>
<span><span class="co">#&gt; Detection Rate        0.005914  0.006452   0.02151   0.01613   0.02312</span></span>
<span><span class="co">#&gt; Detection Prevalence  0.006989  0.010753   0.03011   0.02527   0.03280</span></span>
<span><span class="co">#&gt; Balanced Accuracy     0.922536  0.720040   0.72537   0.82865   0.78550</span></span>
<span><span class="co">#&gt;                      Class: pp Class: rc Class: sg Class: uu Class: zz</span></span>
<span><span class="co">#&gt; Sensitivity            0.62054    0.7256  0.216216 0.0588235    0.8592</span></span>
<span><span class="co">#&gt; Specificity            0.96210    0.8802  0.991772 0.9972870    0.8103</span></span>
<span><span class="co">#&gt; Pos Pred Value         0.69154    0.7344  0.347826 0.1666667    0.7550</span></span>
<span><span class="co">#&gt; Neg Pred Value         0.94876    0.8754  0.984213 0.9913700    0.8943</span></span>
<span><span class="co">#&gt; Prevalence             0.12043    0.3134  0.019892 0.0091398    0.4048</span></span>
<span><span class="co">#&gt; Detection Rate         0.07473    0.2274  0.004301 0.0005376    0.3478</span></span>
<span><span class="co">#&gt; Detection Prevalence   0.10806    0.3097  0.012366 0.0032258    0.4608</span></span>
<span><span class="co">#&gt; Balanced Accuracy      0.79132    0.8029  0.603994 0.5280553    0.8348</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $trained_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  randomForest(formula = train_target ~ ., data = train_data) </span></span>
<span><span class="co">#&gt;                Type of random forest: classification</span></span>
<span><span class="co">#&gt;                      Number of trees: 500</span></span>
<span><span class="co">#&gt; No. of variables tried at each split: 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         OOB estimate of  error rate: 26.87%</span></span>
<span><span class="co">#&gt; Confusion matrix:</span></span>
<span><span class="co">#&gt;    bl cy df fm  jz  pp  rc sg uu   zz class.error</span></span>
<span><span class="co">#&gt; bl 23  0  0  0   0   0   2  0  0    7   0.2812500</span></span>
<span><span class="co">#&gt; cy  0 36  0  0   1   4   7  3  0   12   0.4285714</span></span>
<span><span class="co">#&gt; df  1  0 92  1   7  13  49  0  1   40   0.5490196</span></span>
<span><span class="co">#&gt; fm  0  0  2 73   2   6   9  1  1   14   0.3240741</span></span>
<span><span class="co">#&gt; jz  0  1  2  3 134   3  16  1  1   14   0.2342857</span></span>
<span><span class="co">#&gt; pp  1  2 10  7   1 316  75 10  1  100   0.3957935</span></span>
<span><span class="co">#&gt; rc  1  6 17  5  12  58 983  7  3  271   0.2787968</span></span>
<span><span class="co">#&gt; sg  0  3  0  5   3  18  22 20  1   17   0.7752809</span></span>
<span><span class="co">#&gt; uu  0  0  0  1   0   5  12  3  2   18   0.9512195</span></span>
<span><span class="co">#&gt; zz  5  7 15  8  12  28 168  6  2 1506   0.1428571</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "train_classifier"</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  Length Class                Mode   </span></span>
<span><span class="co">#&gt; accuracy          1     -none-               numeric</span></span>
<span><span class="co">#&gt; confusion_matrix  6     confusionMatrix      list   </span></span>
<span><span class="co">#&gt; trained_model    19     randomForest.formula list</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Manual_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="section level4">
<h4 id="rcpp-code">RCPP code<a class="anchor" aria-label="anchor" href="#rcpp-code"></a>
</h4>
<p>The package also contains c++ method which build additional
statistics using confusion matrix from results: <a href="https://en.wikipedia.org/wiki/Phi_coefficient" class="external-link">Matthews
correlation coefficient (MCC)</a> and <a href="https://en.wikipedia.org/wiki/F-score" class="external-link">F1-score</a>. The original
script is in “src/get_metrics.cpp”. It is taking as input the table
derived from confusion matrix. See example below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#sourceCpp(parent_dir,"src","get_metrics.cpp")</span></span>
<span><span class="fu">classificationMetrics</span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">confusion_matrix</span><span class="op">$</span><span class="va">table</span><span class="op">)</span></span>
<span><span class="co">#&gt;  F1_Score       MCC </span></span>
<span><span class="co">#&gt; 0.5746851 0.5417377</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Svetlana Koroteeva.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
